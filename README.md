# AutoRia Scraper

## –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É

**AutoRia Scraper** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –¥–ª—è —Å–∫—Ä–∞–ø—ñ–Ω–≥—É –æ–≥–æ–ª–æ—à–µ–Ω—å –∑ —Å–∞–π—Ç—É AutoRia –∑ –ø–æ–¥–∞–ª—å—à–∏–º –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º –¥–∞–Ω–∏—Ö —É –±–∞–∑—É –¥–∞–Ω–∏—Ö PostgreSQL. –ü—Ä–æ—î–∫—Ç –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º **FastAPI**, **SQLAlchemy (async)**, **Alembic** —Ç–∞ **Docker**.

–û—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞ ‚Äî **–∑–±—ñ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö –ø—Ä–æ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ –±–µ–∑ –¥—É–±–ª—ñ–≤** —Ç–∞ –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è.

---

## –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –¥—É–±–ª—ñ–≤

–£ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∫—ñ–ª—å–∫–∞ —Ä—ñ–≤–Ω—ñ–≤ –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö:

### 1Ô∏è‚É£ –£–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å URL

–ö–æ–∂–Ω–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π `url`, —è–∫–∏–π –Ω–µ –º–æ–∂–µ –ø–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏—Å—è –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö:

```python
url: Mapped[str] = mapped_column(unique=True, index=True, nullable=False)
```

–ù–∞ —Ä—ñ–≤–Ω—ñ –ë–î —Ü–µ —Å—Ç–≤–æ—Ä—é—î **UNIQUE constraint** (`car_url_key`).

---

### 2Ô∏è‚É£ –°–∫–ª–∞–¥–µ–Ω–∏–π —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å VIN + –Ω–æ–º–µ—Ä –∞–≤—Ç–æ

–î–ª—è –≤–∏–ø–∞–¥–∫—ñ–≤, –∫–æ–ª–∏ URL –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—è, –∞–ª–µ –∞–≤—Ç–æ–º–æ–±—ñ–ª—å —Ç–æ–π —Å–∞–º–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å–∫–ª–∞–¥–µ–Ω–∏–π —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å:

```python
__table_args__ = (
    Index(
        "uq_car_vin_number",
        "car_vin",
        "car_number",
        unique=True
    ),
)
```

üîπ –Ü–Ω–¥–µ–∫—Å –ø—Ä–∞—Ü—é—î –ª–∏—à–µ –∫–æ–ª–∏ **–æ–±–∏–¥–≤–∞ –ø–æ–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ**
üîπ –Ø–∫—â–æ –æ–¥–Ω–µ –∑ –ø–æ–ª—ñ–≤ `NULL`, –æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–µ –ø–æ—Ä—É—à—É—î—Ç—å—Å—è (–ø–æ–≤–µ–¥—ñ–Ω–∫–∞ PostgreSQL)

---

### 3Ô∏è‚É£ –ë–µ–∑–ø–µ—á–Ω–∞ –≤—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö (ON CONFLICT)

–ü—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `ON CONFLICT DO NOTHING`, —â–æ –≥–∞—Ä–∞–Ω—Ç—É—î –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–∞–¥—ñ–Ω—å –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –¥–∞–Ω–∏—Ö:

```python
insert(Car)
    .values(**data)
    .on_conflict_do_nothing(index_elements=["url"])
```

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```text
autoRia/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI application
‚îÇ   ‚îú‚îÄ‚îÄ config/              # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (settings)
‚îÇ   ‚îú‚îÄ‚îÄ models/              # SQLAlchemy models
‚îÇ   ‚îú‚îÄ‚îÄ schemas/             # Pydantic schemas
‚îÇ   ‚îú‚îÄ‚îÄ crud/                # –†–æ–±–æ—Ç–∞ –∑ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ scraper/             # –õ–æ–≥—ñ–∫–∞ —Å–∫—Ä–∞–ø—ñ–Ω–≥—É
‚îÇ   ‚îú‚îÄ‚îÄ scheduler/           # –§–æ–Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ
‚îÇ   ‚îî‚îÄ‚îÄ utils/               # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
‚îÇ
‚îú‚îÄ‚îÄ alembic/                 # –ú—ñ–≥—Ä–∞—Ü—ñ—ó –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ versions/
‚îÇ   ‚îî‚îÄ‚îÄ env.py
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ .env
‚îî‚îÄ‚îÄ dumps/                   # –î–∞–º–ø–∏ –ë–î
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É

### 1Ô∏è‚É£ –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
git clone <repo_url>
cd autoRia
```

---

### 2Ô∏è‚É£ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
docker compose up --build
```

–ü—ñ–¥ —á–∞—Å —Å—Ç–∞—Ä—Ç—É:

* –ø—ñ–¥–Ω—ñ–º–∞—î—Ç—å—Å—è PostgreSQL
* –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å—Å—è Alembic-–º—ñ–≥—Ä–∞—Ü—ñ—ó
* –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è FastAPI-–∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫

---

### 3Ô∏è‚É£ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

FastAPI –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é:

```
http://localhost:8000
```

Swagger UI:

```
http://localhost:8000/docs
```

---

## üõ† –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

### –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤ —É —Ç–∞–±–ª–∏—Ü—ñ `car`

```sql
SELECT COUNT(*) FROM car;
```

### –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î

```bash
docker exec -it db psql -U postgres -d postgres
```

---

## ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏ —Ä—ñ—à–µ–Ω–Ω—è

* –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π —Å–∫—Ä–∞–ø—ñ–Ω–≥ (aiohttp)
* –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –¥—É–±–ª—ñ–≤ –Ω–∞ —Ä—ñ–≤–Ω—ñ –ë–î —Ç–∞ –∫–æ–¥—É
* Docker-first –ø—ñ–¥—Ö—ñ–¥
* –ß–∏—Å—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
* –ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

---


